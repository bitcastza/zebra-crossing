stages:
    - test
    - deploy

test:unit-3:
    script:
        - apt-get update -qq && apt-get install -y -qq python3 python3-pip
        - pip3 install -r requirements.txt
        - python3 --version
        - python3 -m django --version
        - python3 ./manage.py test --parallel 5

deploy:staging:
    stage: deploy
    script:
        - apt-get update && apt-get install -y -qq ansible git
        - ./scripts/deploy.sh
    environment:
        name: staging
        url: https://zebratest.paddatrapper.com
    only:
        - master
